<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Reach Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #0a0e1a;
            color: #ffffff;
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 80px 20px 20px 240px; /* サイドメニュー分の左パディング調整 */
        }

        /* サイドメニュー */
        .sidebar {
            position: fixed;
            top: 60px; /* ヘッダー高さ分下げる */
            left: 0;
            width: 220px;
            height: calc(100vh - 60px);
            background: #0f1722;
            border-right: 1px solid #1a2332;
            overflow-y: auto;
            z-index: 999;
            padding: 15px 0;
        }

        .sidebar-section {
            margin-bottom: 15px;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-item {
            margin-bottom: 1px;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            color: #c9d1d9;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 14px;
            border-left: 3px solid transparent;
        }

        .sidebar-link:hover {
            background: #1a2332;
            color: #00d4ff;
            border-left-color: #00d4ff;
        }

        .sidebar-link.active {
            background: #1a2332;
            color: #00d4ff;
            border-left-color: #00d4ff;
        }

        .sidebar-icon {
            margin-right: 12px;
            font-size: 16px;
        }


        /* サブメニュー */
        .sidebar-submenu {
            list-style: none;
            padding: 0;
            margin: 0;
            display: none;
            background: #0a0e1a;
        }

        .sidebar-submenu.open {
            display: block;
        }

        .sidebar-submenu .sidebar-link {
            padding: 8px 20px 8px 52px;
            font-size: 13px;
            color: #7a8a9a;
        }

        .sidebar-submenu .sidebar-link:hover {
            color: #00d4ff;
        }

        .sidebar-toggle {
            margin-left: auto;
            transition: transform 0.3s ease;
        }

        .sidebar-toggle.open {
            transform: rotate(90deg);
        }

        /* ハンバーガーメニューボタン */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: #c9d1d9;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            margin-right: 15px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .menu-toggle:hover {
            background: #1a2332;
            color: #00d4ff;
        }

        /* サイドメニューオーバーレイ */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
        }

        .sidebar-overlay.active {
            display: block;
        }

        /* ヘッダー */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background: #0a0e1a;
            border-bottom: 1px solid #1a2332;
            z-index: 1000;
            height: 60px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            font-size: 18px;
            font-weight: bold;
            background: linear-gradient(45deg, #00d4ff, #0099ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #7a8a9a;
            font-size: 12px;
            font-weight: normal;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        /* アカウント情報 */
        .account-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-name {
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
        }


        /* クレジット情報 */
        .credit-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 16px;
            background: rgba(0, 212, 255, 0.1);
            border-radius: 20px;
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        .credit-label {
            color: #7a8a9a;
            font-size: 12px;
        }

        .credit-value {
            color: #00d4ff;
            font-size: 14px;
            font-weight: 600;
        }

        /* ユーザーメニュー */
        .user-menu {
            position: relative;
        }

        .user-menu-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background: #1a2332;
            border: 2px solid #2a3a4a;
            color: #c9d1d9;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            position: relative;
        }

        .user-menu-btn:hover {
            border-color: #00d4ff;
            background: #00d4ff;
            color: #0a0e1a;
            transform: scale(1.05);
        }

        .user-menu-btn.active {
            border-color: #00d4ff;
            background: #00d4ff;
            color: #0a0e1a;
        }

        .user-avatar {
            font-size: 18px;
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: #0f1722;
            border: 1px solid #2a3a4a;
            border-radius: 12px;
            padding: 8px 0;
            min-width: 180px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1002;
        }

        .user-dropdown.show {
            display: block;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 16px;
            color: #c9d1d9;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .dropdown-item:hover {
            background: #1a2332;
            color: #00d4ff;
        }

        .dropdown-icon {
            font-size: 16px;
        }

        .dropdown-divider {
            height: 1px;
            background: #2a3a4a;
            margin: 8px 0;
        }
        
        /* 免責事項 */
        .disclaimer {
            background: #1a2332;
            border-radius: 10px;
            padding: 20px;
            margin-top: 40px;
            text-align: left;
        }
        
        .disclaimer h3 {
            color: #7a8a9a;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .disclaimer ul {
            color: #c9d1d9;
            margin-left: 20px;
            line-height: 1.6;
        }
        
        .disclaimer li {
            margin-bottom: 8px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(45deg, #00d4ff, #0099ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* 方向性スコア表示 */
        .score-section {
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
        }

        .score-title {
            font-size: 20px;
            color: #7a8a9a;
            margin-bottom: 20px;
        }

        .score-meter {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto 30px;
        }

        .meter-background {
            height: 60px;
            background: linear-gradient(to right, #ff3b3b, #ff6b6b 30%, #ffdd00 50%, #90ee90 70%, #00ff00);
            border-radius: 30px;
            position: relative;
            overflow: hidden;
            opacity: 0.3;
        }

        .meter-value {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            left: 50%;
            width: 4px;
            height: 80px;
            background: #ffffff;
            border-radius: 2px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            transition: left 0.5s ease-out;
        }

        .score-display {
            font-size: 72px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .score-positive {
            color: #00ff00;
        }

        .score-negative {
            color: #ff3b3b;
        }

        .score-direction {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .score-labels {
            display: flex;
            justify-content: space-between;
            color: #7a8a9a;
            font-size: 14px;
            margin-top: 10px;
        }

        /* 時間足別スコアカード */
        .timeframe-score-card {
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(42, 58, 74, 0.3);
            position: relative;
            overflow: hidden;
        }

        .timeframe-score-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 212, 255, 0.2);
            border-color: rgba(0, 212, 255, 0.5);
        }

        .timeframe-label {
            color: #7a8a9a;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timeframe-meter {
            position: relative;
            height: 12px;
            background: #0f1722;
            border-radius: 6px;
            margin: 15px 0;
            overflow: hidden;
            border: 1px solid rgba(42, 58, 74, 0.5);
        }

        .timeframe-meter-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, #ff3b3b 0%, #ff6b6b 25%, #ffdd00 50%, #90ee90 75%, #00ff00 100%);
            opacity: 0.2;
        }

        .timeframe-meter-fill {
            position: absolute;
            top: 0;
            left: 50%;
            height: 100%;
            border-radius: 5px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }

        /* 負のスコア用（左側に表示） */
        .timeframe-meter-fill.negative {
            right: 50%;
            left: auto;
            transform-origin: right;
        }

        .timeframe-score-value {
            font-size: 32px;
            font-weight: bold;
            margin: 15px 0 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .timeframe-direction {
            color: #c9d1d9;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
            background: rgba(42, 58, 74, 0.3);
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
        }

        /* 時間足重要度インジケーター */
        .timeframe-score-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--importance-color, #2a3a4a);
        }

        /* 時間足重要度レベル */
        .timeframe-score-card.high-importance::before,
        .timeframe-score-card.medium-importance::before,
        .timeframe-score-card.low-importance::before {
            background: linear-gradient(45deg, #7a8a9a, #5a6a7a);
        }

        /* ユーザー選択セクション */
        .user-selection {
            background: #1a2332;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .selection-title {
            font-size: 18px;
            color: #00d4ff;
            margin-bottom: 20px;
            text-align: center;
        }

        /* 方向選択ボタン */
        .direction-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .dir-btn {
            padding: 25px;
            border: 2px solid #2a3a4a;
            background: #0f1722;
            border-radius: 15px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 20px;
            font-weight: bold;
        }

        .dir-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .dir-btn.buy {
            color: #00ff00;
        }

        .dir-btn.buy.active {
            background: linear-gradient(135deg, #00ff0015, #00ff0008);
            border-color: #00ff00;
            box-shadow: 0 0 12px rgba(0, 255, 0, 0.2);
        }

        .dir-btn.sell {
            color: #ff3b3b;
        }

        .dir-btn.sell.active {
            background: linear-gradient(135deg, #ff3b3b15, #ff3b3b08);
            border-color: #ff3b3b;
            box-shadow: 0 0 12px rgba(255, 59, 59, 0.2);
        }

        /* Pips選択 */
        .pips-selection {
            margin-bottom: 30px;
        }

        .pips-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .pips-value {
            font-size: 16px;
            font-weight: 700;
            color: #00d4ff;
        }

        .slider-container {
            position: relative;
            margin-bottom: 12px;
            padding: 8px 6px;
            background: rgba(26, 35, 50, 0.2);
            border-radius: 8px;
            border: 1px solid rgba(42, 58, 74, 0.3);
        }

        .pips-slider {
            width: 100%;
            height: 32px;
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            outline: none;
            cursor: pointer;
            position: relative;
        }

        .pips-slider::-webkit-slider-track {
            width: 100%;
            height: 12px;
            background: linear-gradient(to right, #1a2332 0%, #2a3a4a 50%, #3a4a5a 100%);
            border-radius: 6px;
            border: 1px solid #0a1220;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .pips-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            background: linear-gradient(145deg, #00d4ff, #0099ff);
            border: 2px solid #ffffff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 212, 255, 0.4), 0 1px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
            margin-top: -8px;
        }

        .pips-slider::-webkit-slider-thumb:hover {
            background: linear-gradient(145deg, #00ffff, #00d4ff);
            box-shadow: 0 6px 16px rgba(0, 212, 255, 0.8), 0 3px 8px rgba(0, 0, 0, 0.4);
            transform: scale(1.1);
        }

        .pips-slider::-webkit-slider-thumb:active {
            background: linear-gradient(145deg, #0099ff, #007acc);
            transform: scale(0.95);
        }

        .pips-slider::-moz-range-track {
            width: 100%;
            height: 16px;
            background: linear-gradient(to right, #1a2332 0%, #2a3a4a 50%, #3a4a5a 100%);
            border-radius: 8px;
            border: 2px solid #0a1220;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .pips-slider::-moz-range-thumb {
            width: 36px;
            height: 36px;
            background: linear-gradient(145deg, #00d4ff, #0099ff);
            border: 3px solid #ffffff;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.6), 0 2px 6px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;
        }

        .pips-slider::-moz-range-thumb:hover {
            background: linear-gradient(145deg, #00ffff, #00d4ff);
            box-shadow: 0 6px 16px rgba(0, 212, 255, 0.8), 0 3px 8px rgba(0, 0, 0, 0.4);
            transform: scale(1.1);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            color: #7a8a9a;
            font-size: 10px;
            margin-top: 6px;
            padding: 0 4px;
            font-weight: 500;
        }

        /* スライダーのプログレスバー効果 */
        .pips-slider {
            background: linear-gradient(to right, 
                #00d4ff 0%, 
                #00d4ff var(--progress, 50%), 
                #2a3a4a var(--progress, 50%), 
                #2a3a4a 100%
            );
            background-size: 100% 16px;
            background-repeat: no-repeat;
            background-position: center;
            border-radius: 8px;
        }

        /* 勝率計算結果 */
        .result-section {
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            border: 1px solid #00d4ff;
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.1);
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            text-align: center;
        }

        .result-item h3 {
            color: #7a8a9a;
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .result-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .win-rate {
            color: #00ff00;
        }

        .loss-rate {
            color: #ff3b3b;
        }

        .result-detail {
            color: #7a8a9a;
            font-size: 14px;
        }

        /* 計算ボタン */
        .calc-button {
            display: block;
            width: 100%;
            max-width: 320px;
            margin: 16px auto 0;
            padding: 16px;
            background: linear-gradient(135deg, #00d4ff, #0099ff);
            color: #ffffff;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 212, 255, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .calc-button:hover {
            background: linear-gradient(135deg, #00ffff, #00d4ff);
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(0, 212, 255, 0.4);
        }

        .calc-button:disabled {
            background: #2a3a4a;
            color: #7a8a9a;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.6;
        }

        /* 追加情報 */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: #1a2332;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .info-title {
            color: #7a8a9a;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .info-value {
            font-size: 24px;
            font-weight: bold;
            color: #ffffff;
        }

        /* 大画面対応 */
        @media (min-width: 1600px) {
            .container {
                max-width: 1800px;
                padding: 80px 30px 20px 250px;
            }
        }

        /* レスポンシブ */
        @media (max-width: 1200px) {
            /* 中画面では2カラムレイアウトを縦に変更 */
            .container > div:first-of-type {
                grid-template-columns: 1fr !important;
                gap: 20px !important;
            }
            
            .container > div:first-of-type > div:first-child {
                order: 1;
            }
            
            .container > div:first-of-type > div:last-child {
                order: 2;
            }
        }

        @media (max-width: 768px) {
            /* ハンバーガーメニューボタンを表示 */
            .menu-toggle {
                display: block;
            }

            /* サイドメニューを隠す */
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 1001;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .header {
                padding: 10px 15px;
                height: 50px;
            }

            .container {
                padding: 70px 15px 15px 15px; /* サイドメニュー用の左パディングを削除 */
            }

            .logo {
                font-size: 16px;
            }

            .subtitle {
                font-size: 11px;
            }

            .header-right {
                gap: 15px;
            }

            .user-name {
                font-size: 13px;
            }

            /* 2カラムレイアウトを縦並びに */
            .container > div:first-of-type {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }

            .score-display {
                font-size: 48px;
            }

            .result-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .result-value {
                font-size: 28px;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .direction-buttons {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .dir-btn {
                padding: 14px 10px;
                font-size: 14px;
            }
            
            /* チャートの高さをモバイルで調整 */
            .container div[style*="height: 600"] {
                height: 400px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <button class="menu-toggle" onclick="toggleSidebar()">☰</button>
                <h1 class="logo">Market Reach Analyzer</h1>
            </div>
            
            <div class="header-right">
                <!-- クレジット情報 -->
                <div class="credit-info">
                    <span class="credit-label">クレジット</span>
                    <span class="credit-value">100/300</span>
                </div>
                
                <!-- ユーザーメニュー -->
                <div class="user-menu">
                    <button class="user-menu-btn" onclick="toggleUserMenu(this)">
                        <span class="user-avatar">👤</span>
                    </button>
                    <div class="user-dropdown">
                        <div style="padding: 12px 16px; border-bottom: 1px solid #2a3a4a; margin-bottom: 8px;">
                            <div style="color: #ffffff; font-weight: 600; margin-bottom: 4px;">田中太郎</div>
                            <div style="color: #7a8a9a; font-size: 12px;">Proプラン</div>
                        </div>
                        <a href="#" class="dropdown-item">
                            <span class="dropdown-icon">👤</span>
                            マイアカウント
                        </a>
                        <a href="#" class="dropdown-item">
                            <span class="dropdown-icon">⚙️</span>
                            アカウント設定
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item">
                            <span class="dropdown-icon">🚪</span>
                            ログアウト
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- サイドメニューオーバーレイ -->
        <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

        <!-- サイドメニュー -->
        <nav class="sidebar" id="sidebar">
            <!-- ダッシュボード -->
            <div class="sidebar-section">
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link active">
                            <span class="sidebar-icon">🏠</span>
                            ダッシュボード
                        </a>
                    </li>
                </ul>
            </div>

            <!-- AIレポート -->
            <div class="sidebar-section">
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link" onclick="toggleSubmenu(this)">
                            <span class="sidebar-icon">📄</span>
                            AIレポート
                        </a>
                        <ul class="sidebar-submenu">
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📅</span>デイリーレポート</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📊</span>週次マーケット分析</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">🎯</span>注目銘柄レポート</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📈</span>テクニカル分析</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">🌐</span>マクロ経済レポート</a></li>
                        </ul>
                    </li>
                </ul>
            </div>

            <!-- アラート -->
            <div class="sidebar-section">
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link" onclick="toggleSubmenu(this)">
                            <span class="sidebar-icon">🎯</span>
                            アラート
                        </a>
                        <ul class="sidebar-submenu">
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📢</span>アクティブアラート (3)</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">➕</span>新規アラート作成</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📊</span>アラート履歴</a></li>
                        </ul>
                    </li>
                </ul>
            </div>

            <!-- マイアカウント -->
            <div class="sidebar-section">
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link" onclick="toggleSubmenu(this)">
                            <span class="sidebar-icon">💼</span>
                            マイアカウント
                        </a>
                        <ul class="sidebar-submenu">
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📊</span>分析履歴</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">💳</span>クレジット管理</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📈</span>利用統計</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">⚙️</span>アカウント設定</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">🌐</span>言語設定</a></li>
                        </ul>
                    </li>
                </ul>
            </div>

            <!-- 学習センター -->
            <div class="sidebar-section">
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link" onclick="toggleSubmenu(this)">
                            <span class="sidebar-icon">📚</span>
                            学習センター
                        </a>
                        <ul class="sidebar-submenu">
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">🎓</span>基本ガイド</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📖</span>スコア解説</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">🎥</span>使い方動画</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">❓</span>FAQ</a></li>
                        </ul>
                    </li>
                </ul>
            </div>

            <!-- サポート -->
            <div class="sidebar-section">
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link" onclick="toggleSubmenu(this)">
                            <span class="sidebar-icon">🆘</span>
                            サポート
                        </a>
                        <ul class="sidebar-submenu">
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">💬</span>チャットサポート</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">📧</span>お問い合わせ</a></li>
                            <li><a href="#" class="sidebar-link"><span class="sidebar-icon">🐛</span>不具合報告</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- 2カラムレイアウト: チャート + シミュレーションツール -->
        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px; margin-bottom: 30px;">
            <!-- 左カラム: TradingViewチャート -->
            <div style="background: #1a2332; border-radius: 20px; padding: 20px;">
                <h3 style="color: #00d4ff; margin-bottom: 20px;">BTC/USD チャート</h3>
                <!-- TradingView Widget BEGIN -->
                <div class="tradingview-widget-container">
                    <div id="tradingview_btc"></div>
                    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
                    <script type="text/javascript">
                    new TradingView.widget(
                    {
                        "width": "100%",
                        "height": 600,
                        "symbol": "BITSTAMP:BTCUSD",
                        "interval": "60",
                        "timezone": "Asia/Tokyo",
                        "theme": "dark",
                        "style": "1",
                        "locale": "ja",
                        "enable_publishing": false,
                        "allow_symbol_change": true,
                        "container_id": "tradingview_btc",
                        "drawings_access": {
                            "type": "black",
                            "tools": [
                                { "name": "Regression Trend" },
                                { "name": "Trend Line" },
                                { "name": "Horizontal Line" },
                                { "name": "Vertical Line" },
                                { "name": "Cross Line" },
                                { "name": "Rectangle" },
                                { "name": "Circle" },
                                { "name": "Arrow" },
                                { "name": "Text" },
                                { "name": "Note" },
                                { "name": "Fibonacci Retracement" },
                                { "name": "Fibonacci Extension" },
                                { "name": "Price Range" },
                                { "name": "Measure" }
                            ]
                        },
                        "enabled_features": [
                            "study_templates",
                            "use_localstorage_for_settings",
                            "save_chart_properties_to_local_storage",
                            "chart_property_page_style",
                            "disable_resolution_rebuild",
                            "chart_template"
                        ],
                        "disabled_features": [
                            "popup_hints"
                        ],
                        "toolbar_bg": "#1a2332",
                        "hide_side_toolbar": false
                    }
                    );
                    </script>
                </div>
                <!-- TradingView Widget END -->
            </div>

            <!-- 右カラム: 投資シミュレーションツール -->
        <div class="user-selection">
            <h3 class="selection-title">投資シミュレーションツール</h3>
            
            <!-- 方向選択 -->
            <div class="direction-buttons">
                <button class="dir-btn buy" onclick="selectDirection('buy')">
                    <div style="font-size: 22px; margin-bottom: 4px;">↑</div>
                    <div style="font-size: 13px;">買い（ロング）</div>
                </button>
                <button class="dir-btn sell" onclick="selectDirection('sell')">
                    <div style="font-size: 22px; margin-bottom: 4px;">↓</div>
                    <div style="font-size: 13px;">売り（ショート）</div>
                </button>
            </div>

            <!-- TP/SL Pips選択 -->
            <div class="pips-selection">
                <!-- TP設定 -->
                <div style="margin-bottom: 16px;">
                    <div class="pips-label">
                        <span style="color: #7a8a9a; font-size: 13px;">利確幅（TP）</span>
                        <span class="pips-value" id="tpPipsValue" style="font-size: 14px; font-weight: 600;">50 pips</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="pips-slider" id="tpPipsSlider" 
                               min="10" max="100" value="50" step="5"
                               oninput="updateTpPips(this.value)">
                    </div>
                    <div class="slider-labels">
                        <span>10</span>
                        <span>30</span>
                        <span>50</span>
                        <span>70</span>
                        <span>100</span>
                    </div>
                </div>

                <!-- SL設定 -->
                <div style="margin-bottom: 16px;">
                    <div class="pips-label">
                        <span style="color: #7a8a9a; font-size: 13px;">損切り幅（SL）</span>
                        <span class="pips-value" id="slPipsValue" style="font-size: 14px; font-weight: 600;">20 pips</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="pips-slider" id="slPipsSlider" 
                               min="10" max="100" value="20" step="5"
                               oninput="updateSlPips(this.value)">
                    </div>
                    <div class="slider-labels">
                        <span>10</span>
                        <span>30</span>
                        <span>50</span>
                        <span>70</span>
                        <span>100</span>
                    </div>
                </div>

                <!-- リスクリワード比表示 -->
                <div style="background: #0f1722; padding: 12px; border-radius: 8px; text-align: center; border: 1px solid rgba(42, 58, 74, 0.4);">
                    <div style="color: #7a8a9a; font-size: 12px; margin-bottom: 4px;">リスクリワード比</div>
                    <div style="font-size: 18px; font-weight: 700; color: #00d4ff;" id="riskRewardRatio">2.5 : 1</div>
                </div>
            </div>

            <button class="calc-button" id="calcButton" onclick="calculatePatternAnalysis()" disabled style="padding: 14px; font-size: 15px; font-weight: 600; margin-bottom: 16px;">
                分析実行
            </button>
            
            <!-- クレジット消費説明 -->
            <div style="text-align: center; margin-top: 8px; padding: 10px; background: rgba(0, 212, 255, 0.08); border-radius: 6px; border: 1px solid rgba(0, 212, 255, 0.15);">
                <div style="color: #00d4ff; font-size: 12px; font-weight: 500;">
                    <span style="margin-right: 6px;">💳</span>この分析には1クレジットが消費されます
                </div>
                <div style="color: #7a8a9a; font-size: 11px; margin-top: 3px;">
                    分析実行後、残りクレジット数が更新されます
                </div>
            </div>

            <!-- 分析結果セクション（右カラム内） -->
            <div class="result-section" id="resultSection" style="display: none; margin-top: 20px;">
                <h3 style="text-align: center; color: #00d4ff; margin-bottom: 20px; font-size: 18px;">
                    分析結果
                </h3>
                <div class="result-grid">
                    <div class="result-item">
                        <h3>ターゲット到達パターン</h3>
                        <div class="result-value win-rate" id="tpRate">68%</div>
                    </div>
                    <div class="result-item">
                        <h3>ストップ到達パターン</h3>
                        <div class="result-value loss-rate" id="slRate">32%</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #0f1722; border-radius: 8px;">
                    <h4 style="color: #00d4ff; margin-bottom: 12px; font-size: 14px;">詳細分析</h4>
                    <div style="display: grid; gap: 8px; color: #c9d1d9; font-size: 12px;">
                        <div>• 過去データ件数: <span style="color: #00d4ff;">152件</span></div>
                        <div>• データパターン一致: <span style="color: #00ff00;">○</span></div>
                        <div>• リスクリワード比: <span style="color: #00d4ff;" id="rrAnalysis">2.5:1</span></div>
                        <div>• 期待値: <span style="color: #00d4ff;" id="expectedValue">+12.6 pips</span></div>
                        <div>• 予想時間: <span style="color: #00d4ff;">約2.5時間</span></div>
                    </div>
                </div>
            </div>
        </div>
        
        </div> <!-- 2カラムレイアウト終了 -->

        <!-- 相場状況 -->
        <div style="background: #1a2332; border-radius: 12px; padding: 20px; margin-bottom: 24px; border: 1px solid rgba(42, 58, 74, 0.3);">
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                <h3 style="color: #00d4ff; margin: 0; font-size: 16px; font-weight: 600;">相場状況</h3>
                <span style="color: #00ff00; font-size: 13px; font-weight: 600; padding: 3px 8px; background: rgba(0, 255, 0, 0.1); border-radius: 12px; border: 1px solid rgba(0, 255, 0, 0.2);">トレンド相場</span>
            </div>
            
            <!-- 相場指標 -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 16px;">
                <div style="background: #0f1722; border-radius: 8px; padding: 12px; text-align: center; border: 1px solid rgba(42, 58, 74, 0.2);">
                    <div style="color: #7a8a9a; font-size: 11px; margin-bottom: 4px; font-weight: 500;">ATR（平均変動幅）</div>
                    <div style="color: #00d4ff; font-size: 16px; font-weight: 700;">$425</div>
                </div>
                <div style="background: #0f1722; border-radius: 8px; padding: 12px; text-align: center; border: 1px solid rgba(42, 58, 74, 0.2);">
                    <div style="color: #7a8a9a; font-size: 11px; margin-bottom: 4px; font-weight: 500;">類似度スコア</div>
                    <div style="color: #00ff00; font-size: 16px; font-weight: 700;">87%</div>
                </div>
                <div style="background: #0f1722; border-radius: 8px; padding: 12px; text-align: center; border: 1px solid rgba(42, 58, 74, 0.2);">
                    <div style="color: #7a8a9a; font-size: 11px; margin-bottom: 4px; font-weight: 500;">トレンド強度</div>
                    <div style="color: #00ff00; font-size: 16px; font-weight: 700;">強い</div>
                </div>
            </div>
            
            <!-- 重要イベント -->
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; align-items: center; gap: 15px; padding: 10px; background: #0f1722; border-radius: 8px;">
                    <div style="width: 40px; height: 40px; background: #00d4ff20; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #00d4ff; font-weight: bold;">📊</div>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; margin-bottom: 2px;">米CPI発表</div>
                        <div style="color: #7a8a9a; font-size: 12px;">残り4時間23分</div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 15px; padding: 10px; background: #0f1722; border-radius: 8px;">
                    <div style="width: 40px; height: 40px; background: #00d4ff20; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #00d4ff; font-weight: bold;">💰</div>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; margin-bottom: 2px;">ETF資金流入</div>
                        <div style="color: #7a8a9a; font-size: 12px;">+$285M（直近24h）</div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 15px; padding: 10px; background: #0f1722; border-radius: 8px;">
                    <div style="width: 40px; height: 40px; background: #00d4ff20; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #00d4ff; font-weight: bold;">🐋</div>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; margin-bottom: 2px;">大口注文増加</div>
                        <div style="color: #7a8a9a; font-size: 12px;">$43,000付近に買い注文集中</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI総合解説 -->
        <div style="background: #1a2332; border-left: 4px solid #00d4ff; border-radius: 15px; padding: 25px;">
            <h3 style="color: #00d4ff; margin-bottom: 15px;">AI総合解説</h3>
            <p style="color: #c9d1d9; font-size: 16px; line-height: 1.8; margin-bottom: 20px;">
                現在のBTC市場は明確な上昇トレンド環境にあります。方向性スコア+44は買い優勢を示しており、ETFへの継続的な資金流入（+$285M）と大口注文の買い集中により需給バランスは良好です。類似度スコア87%は過去の成功パターンと高い一致率を示しており、トレード精度向上が期待できます。
            </p>
            <p style="color: #c9d1d9; font-size: 16px; line-height: 1.8; margin-bottom: 20px;">
                ただし、4時間23分後のCPI発表を控えており、指標結果次第では短期的な変動が予想されます。ATRは$425と適度なボラティリティを示しているため、20-30pips幅でのデイトレードが最適と判断されます。現在のトレンド強度は「強い」状況であり、押し目での買いエントリーが有効な戦略となります。
            </p>
            <div style="padding: 15px; background: #0f1722; border-radius: 10px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <span style="color: #7a8a9a; font-size: 14px;">データ分析結果</span>
                    <span style="color: #00ff00; font-weight: bold; font-size: 18px;">上昇傾向を検出</span>
                </div>
                <div style="font-size: 14px; color: #7a8a9a;">
    トレンド環境良好 × 高類似度 × 適正ボラティリティ → 上昇データパターンを検出
                </div>
            </div>
        </div>

        <!-- スコア構成要素 -->
        <h3 style="color: #00d4ff; margin-bottom: 20px;">スコア構成要素</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
            <!-- 時間足別スコア -->
            <div style="background: #1a2332; border-radius: 15px; padding: 20px; transition: all 0.3s;" 
                 onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0, 0, 0, 0.3)'"
                 onmouseout="this.style.transform='none'; this.style.boxShadow='none'">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="color: #00d4ff;">時間足別スコア</span>
                    <span style="font-size: 24px; font-weight: bold; color: #00ff00;">+44</span>
                </div>
                <div style="background: #0f1722; height: 30px; border-radius: 15px; overflow: hidden; margin-bottom: 10px;">
                    <div style="height: 100%; width: 72%; background: linear-gradient(to right, #00d4ff, #00ff00); transition: width 0.5s;"></div>
                </div>
                <div style="color: #7a8a9a; font-size: 14px; margin-bottom: 15px;">多時間足総合分析</div>
                
                <!-- ミニ時間足スコアグリッド -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px;">
                    <!-- 5分足 -->
                    <div style="background: #0f1722; border-radius: 8px; padding: 8px; text-align: center;">
                        <div style="color: #7a8a9a; font-size: 10px; margin-bottom: 5px;">5分</div>
                        <div style="font-size: 14px; font-weight: bold; color: #ff3b3b;">-8</div>
                    </div>
                    <!-- 15分足 -->
                    <div style="background: #0f1722; border-radius: 8px; padding: 8px; text-align: center;">
                        <div style="color: #7a8a9a; font-size: 10px; margin-bottom: 5px;">15分</div>
                        <div style="font-size: 14px; font-weight: bold; color: #ffdd00;">+12</div>
                    </div>
                    <!-- 1時間足 -->
                    <div style="background: #0f1722; border-radius: 8px; padding: 8px; text-align: center;">
                        <div style="color: #7a8a9a; font-size: 10px; margin-bottom: 5px;">1時間</div>
                        <div style="font-size: 14px; font-weight: bold; color: #00ff00;">+35</div>
                    </div>
                    <!-- 4時間足 -->
                    <div style="background: #0f1722; border-radius: 8px; padding: 8px; text-align: center;">
                        <div style="color: #7a8a9a; font-size: 10px; margin-bottom: 5px;">4時間</div>
                        <div style="font-size: 14px; font-weight: bold; color: #00ff00;">+48</div>
                    </div>
                    <!-- 日足 -->
                    <div style="background: #0f1722; border-radius: 8px; padding: 8px; text-align: center;">
                        <div style="color: #7a8a9a; font-size: 10px; margin-bottom: 5px;">日足</div>
                        <div style="font-size: 14px; font-weight: bold; color: #00ff00;">+62</div>
                    </div>
                    <!-- 週足 -->
                    <div style="background: #0f1722; border-radius: 8px; padding: 8px; text-align: center;">
                        <div style="color: #7a8a9a; font-size: 10px; margin-bottom: 5px;">週足</div>
                        <div style="font-size: 14px; font-weight: bold; color: #00ff00;">+70</div>
                    </div>
                </div>
                
                <div style="margin-top: 15px; padding: 15px; background: #0f1722; border-radius: 10px; font-size: 14px; line-height: 1.6; color: #c9d1d9; border-left: 3px solid #00d4ff;">
                    上位時間足（4時間、日、週）が全て強い買いシグナルを示しており、長期トレンドは明確に上昇方向です。短期の5分足は逆張りですが、全体の方向性には影響しません。
                </div>
            </div>

            <!-- 市場資金循環 -->
            <div style="background: #1a2332; border-radius: 15px; padding: 20px; transition: all 0.3s;" 
                 onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0, 0, 0, 0.3)'"
                 onmouseout="this.style.transform='none'; this.style.boxShadow='none'">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="color: #00d4ff;">市場資金循環</span>
                    <span style="font-size: 24px; font-weight: bold; color: #00ff00;">+75</span>
                </div>
                <div style="background: #0f1722; height: 30px; border-radius: 15px; overflow: hidden; margin-bottom: 10px;">
                    <div style="height: 100%; width: 75%; background: linear-gradient(to right, #00d4ff, #00ff00); transition: width 0.5s;"></div>
                </div>
                <div style="color: #7a8a9a; font-size: 14px; margin-bottom: 15px;">株式市場好調、リスクオン環境</div>
                <div style="border-top: 1px solid #2a3a4a; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">S&P500（3日変化）</span>
                        <span>+2.1%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">米10年債利回り</span>
                        <span>4.12% ↓</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">ドル指数（DXY）</span>
                        <span>-0.5%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">金（XAU/USD）</span>
                        <span>-1.2%</span>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #0f1722; border-radius: 10px; font-size: 14px; line-height: 1.6; color: #c9d1d9; border-left: 3px solid #00d4ff;">
                    株式市場の上昇とドル安、さらに金が売られている状況は、典型的なリスクオン相場を示しています。投資家のリスク選好姿勢が強く、株式や暗号資産などのリスク資産に資金が向かいやすい環境です。
                </div>
            </div>

            <!-- BTC需給 -->
            <div style="background: #1a2332; border-radius: 15px; padding: 20px; transition: all 0.3s;" 
                 onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0, 0, 0, 0.3)'"
                 onmouseout="this.style.transform='none'; this.style.boxShadow='none'">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="color: #00d4ff;">BTC需給</span>
                    <span style="font-size: 24px; font-weight: bold; color: #00ff00;">+85</span>
                </div>
                <div style="background: #0f1722; height: 30px; border-radius: 15px; overflow: hidden; margin-bottom: 10px;">
                    <div style="height: 100%; width: 85%; background: linear-gradient(to right, #00d4ff, #00ff00); transition: width 0.5s;"></div>
                </div>
                <div style="color: #7a8a9a; font-size: 14px; margin-bottom: 15px;">ETF継続流入、取引所残高減少</div>
                <div style="border-top: 1px solid #2a3a4a; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">ETF純流入（日次）</span>
                        <span>+$285M</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">取引所BTC残高</span>
                        <span>-12,000 BTC</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">長期保有者比率</span>
                        <span>67.2% ↑</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">ハッシュレート</span>
                        <span>420 EH/s</span>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #0f1722; border-radius: 10px; font-size: 14px; line-height: 1.6; color: #c9d1d9; border-left: 3px solid #00d4ff;">
                    ETFへの大規模な資金流入と取引所からのBTC流出が同時に起きており、需給バランスは極めて良好です。長期保有者の増加は売り圧力の低下を意味し、中期的な価格上昇を強く支持します。
                </div>
            </div>

            <!-- マクロ環境 -->
            <div style="background: #1a2332; border-radius: 15px; padding: 20px; transition: all 0.3s;" 
                 onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0, 0, 0, 0.3)'"
                 onmouseout="this.style.transform='none'; this.style.boxShadow='none'">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="color: #00d4ff;">マクロ環境</span>
                    <span style="font-size: 24px; font-weight: bold; color: #00ff00;">+60</span>
                </div>
                <div style="background: #0f1722; height: 30px; border-radius: 15px; overflow: hidden; margin-bottom: 10px;">
                    <div style="height: 100%; width: 60%; background: linear-gradient(to right, #00d4ff, #00ff00); transition: width 0.5s;"></div>
                </div>
                <div style="color: #7a8a9a; font-size: 14px; margin-bottom: 15px;">金利低下見通し、緩和的</div>
                <div style="border-top: 1px solid #2a3a4a; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">政策金利</span>
                        <span>5.25% (横ばい)</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">CPI前年比</span>
                        <span>3.2% ↓</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">次回FOMC予想</span>
                        <span>据え置き 85%</span>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #0f1722; border-radius: 10px; font-size: 14px; line-height: 1.6; color: #c9d1d9; border-left: 3px solid #00d4ff;">
                    インフレ率の低下により利上げサイクルは終了局面にあり、市場は次の利下げを織り込み始めています。この金融政策の転換期待はリスク資産全般にとって追い風となっています。
                </div>
            </div>

            <!-- 市場心理 -->
            <div style="background: #1a2332; border-radius: 15px; padding: 20px; transition: all 0.3s;" 
                 onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0, 0, 0, 0.3)'"
                 onmouseout="this.style.transform='none'; this.style.boxShadow='none'">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="color: #00d4ff;">市場心理</span>
                    <span style="font-size: 24px; font-weight: bold; color: #ffdd00;">+40</span>
                </div>
                <div style="background: #0f1722; height: 30px; border-radius: 15px; overflow: hidden; margin-bottom: 10px;">
                    <div style="height: 100%; width: 40%; background: linear-gradient(to right, #00d4ff, #00ff00); transition: width 0.5s;"></div>
                </div>
                <div style="color: #7a8a9a; font-size: 14px; margin-bottom: 15px;">楽観優勢、過熱感なし</div>
                <div style="border-top: 1px solid #2a3a4a; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">Fear & Greed</span>
                        <span>68 (貪欲)</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">SNSセンチメント</span>
                        <span>72% ポジティブ</span>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #0f1722; border-radius: 10px; font-size: 14px; line-height: 1.6; color: #c9d1d9; border-left: 3px solid #00d4ff;">
                    市場は楽観的ですが極端な過熱感はなく、健全な上昇局面にあります。SNSでのポジティブな議論が継続しており、新規参加者の流入が期待できる状況です。
                </div>
            </div>

            <!-- ポジション構造 -->
            <div style="background: #1a2332; border-radius: 15px; padding: 20px; transition: all 0.3s;" 
                 onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0, 0, 0, 0.3)'"
                 onmouseout="this.style.transform='none'; this.style.boxShadow='none'">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="color: #00d4ff;">ポジション構造</span>
                    <span style="font-size: 24px; font-weight: bold; color: #ff6b6b;">-20</span>
                </div>
                <div style="background: #0f1722; height: 30px; border-radius: 15px; overflow: hidden; margin-bottom: 10px;">
                    <div style="height: 100%; width: 20%; background: linear-gradient(to right, #ff3b3b, #ff6b6b); transition: width 0.5s;"></div>
                </div>
                <div style="color: #7a8a9a; font-size: 14px; margin-bottom: 15px;">ロング偏り、調整リスクあり</div>
                <div style="border-top: 1px solid #2a3a4a; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">ロング/ショート比</span>
                        <span>1.85</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">Funding Rate</span>
                        <span>0.025%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">OI増減</span>
                        <span>+8.5%</span>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #0f1722; border-radius: 10px; font-size: 14px; line-height: 1.6; color: #c9d1d9; border-left: 3px solid #00d4ff;">
                    ロングポジションの偏りが見られ、急落時には清算による下落加速のリスクがあります。ただしFunding Rateは極端ではなく、現時点では管理可能なレベルに留まっています。
                </div>
            </div>

            <!-- クジラ動向 -->
            <div style="background: #1a2332; border-radius: 15px; padding: 20px; transition: all 0.3s;" 
                 onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0, 0, 0, 0.3)'"
                 onmouseout="this.style.transform='none'; this.style.boxShadow='none'">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="color: #00d4ff;">クジラ動向</span>
                    <span style="font-size: 24px; font-weight: bold; color: #00ff00;">+55</span>
                </div>
                <div style="background: #0f1722; height: 30px; border-radius: 15px; overflow: hidden; margin-bottom: 10px;">
                    <div style="height: 100%; width: 55%; background: linear-gradient(to right, #00d4ff, #00ff00); transition: width 0.5s;"></div>
                </div>
                <div style="color: #7a8a9a; font-size: 14px; margin-bottom: 15px;">大口蓄積フェーズ</div>
                <div style="border-top: 1px solid #2a3a4a; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">1000BTC+ウォレット</span>
                        <span>+2.3%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #0f1722; font-size: 14px;">
                        <span style="color: #7a8a9a;">大口移動</span>
                        <span>通常レベル</span>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #0f1722; border-radius: 10px; font-size: 14px; line-height: 1.6; color: #c9d1d9; border-left: 3px solid #00d4ff;">
                    クジラ（大口保有者）は着実にBTCを蓄積しており、売却の兆候は見られません。これは長期的な価格上昇への確信を示しており、相場の底堅さを支えています。
                </div>
            </div>
        </div>

        <!-- 免責事項 -->
        <div class="disclaimer">
            <h3>重要な免責事項</h3>
            <ul>
                <li><strong>本ツールは情報提供および教育目的のみ</strong>であり、投資助言や投資勧誘ではありません。</li>
                <li><strong>投資の最終判断は必ずご自身で行ってください。</strong>当ツールの情報に基づく投資判断の責任は一切負いません。</li>
                <li>表示されるスコアや分析結果は過去のデータに基づく統計的分析であり、将来の価格動向を保証するものではありません。</li>
                <li>暗号資産投資には価格変動リスクがあり、投資元本を割り込む可能性があります。</li>
                <li>当ツールのご利用は自己責任でお願いいたします。</li>
            </ul>
        </div>

    </div>

    
    <script>
        let selectedDirection = null;
        let selectedTpPips = 50;
        let selectedSlPips = 20;

        // 方向性スコアの動的更新（デモ用）
        setInterval(() => {
            const score = Math.floor(Math.random() * 100) - 50;
            updateScore(score);
        }, 5000);

        function updateScore(score) {
            const scoreElement = document.getElementById('scoreValue');
            const meterValue = document.getElementById('meterValue');
            
            // スコア表示更新
            scoreElement.textContent = score > 0 ? `+${score}` : score;
            
            // 色の更新
            if (score > 20) {
                scoreElement.className = 'score-display score-positive';
            } else if (score < -20) {
                scoreElement.className = 'score-display score-negative';
            } else {
                scoreElement.className = 'score-display';
                scoreElement.style.color = '#ffdd00';
            }
            
            // メーター位置更新
            const position = ((score + 100) / 200) * 100;
            meterValue.style.left = position + '%';
        }

        function selectDirection(direction) {
            selectedDirection = direction;
            
            // ボタンのアクティブ状態を更新
            document.querySelectorAll('.dir-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (direction === 'buy') {
                document.querySelector('.dir-btn.buy').classList.add('active');
            } else {
                document.querySelector('.dir-btn.sell').classList.add('active');
            }
            
            // 計算ボタンを有効化
            document.getElementById('calcButton').disabled = false;
        }

        function updateTpPips(value) {
            selectedTpPips = parseInt(value);
            document.getElementById('tpPipsValue').textContent = value + ' pips';
            
            // プログレスバーの視覚更新
            const progress = ((value - 10) / (100 - 10)) * 100;
            document.getElementById('tpPipsSlider').style.setProperty('--progress', progress + '%');
            
            updateRiskReward();
        }

        function updateSlPips(value) {
            selectedSlPips = parseInt(value);
            document.getElementById('slPipsValue').textContent = value + ' pips';
            
            // プログレスバーの視覚更新
            const progress = ((value - 10) / (100 - 10)) * 100;
            document.getElementById('slPipsSlider').style.setProperty('--progress', progress + '%');
            
            updateRiskReward();
        }

        function updateRiskReward() {
            const ratio = selectedTpPips / selectedSlPips;
            const formattedRatio = ratio % 1 === 0 ? ratio.toString() : ratio.toFixed(1);
            document.getElementById('riskRewardRatio').textContent = formattedRatio + ' : 1';
        }

        function calculatePatternAnalysis() {
            if (!selectedDirection) return;
            
            // 結果セクションを表示
            document.getElementById('resultSection').style.display = 'block';
            
            // スコアベースで過去パターンを分析
            const currentScore = parseInt(document.getElementById('scoreValue').textContent);
            let baseTpRate = 50;
            
            // 方向性と現在のスコアが一致している場合のパターン調整
            if ((selectedDirection === 'buy' && currentScore > 0) || 
                (selectedDirection === 'sell' && currentScore < 0)) {
                baseTpRate += Math.abs(currentScore) * 0.3;
            } else {
                baseTpRate -= Math.abs(currentScore) * 0.2;
            }
            
            // TP幅による過去パターン調整
            const tpAdjustment = Math.max(-20, Math.min(15, (30 - selectedTpPips) * 0.5));
            baseTpRate += tpAdjustment;
            
            // SL幅による過去パターン調整
            const slAdjustment = Math.max(-15, Math.min(20, (selectedSlPips - 30) * 0.3));
            baseTpRate += slAdjustment;
            
            // パターン一致率を10-90の範囲に収める
            baseTpRate = Math.max(10, Math.min(90, baseTpRate));
            const baseSlRate = 100 - baseTpRate;
            
            // 結果を表示
            const tpRate = Math.round(baseTpRate);
            const slRate = Math.round(baseSlRate);
            
            document.getElementById('tpRate').textContent = tpRate + '%';
            document.getElementById('slRate').textContent = slRate + '%';
            
            // 表示用pips値を更新
            document.getElementById('tpPipsDisplay').textContent = selectedTpPips + ' pips';
            document.getElementById('slPipsDisplay').textContent = selectedSlPips + ' pips';
            
            // シミュレーション結果を計算
            const expectedValue = ((selectedTpPips * tpRate / 100) - (selectedSlPips * slRate / 100)).toFixed(1);
            document.getElementById('expectedValue').textContent = (expectedValue > 0 ? '+' : '') + expectedValue + ' pips';
            
            // リスクリワード分析を更新
            const rrRatio = selectedTpPips / selectedSlPips;
            const formattedRrRatio = rrRatio % 1 === 0 ? rrRatio.toString() : rrRatio.toFixed(1);
            document.getElementById('rrAnalysis').textContent = formattedRrRatio + ':1';
            
            // スムーズにスクロール
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        // 言語切り替え機能
        function switchLanguage(lang) {
            // ボタンのアクティブ状態を更新
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (lang === 'ja') {
                document.querySelector('.lang-btn[onclick*="ja"]').classList.add('active');
                // 日本語表示の処理（現在は日本語がデフォルト）
            } else {
                document.querySelector('.lang-btn[onclick*="en"]').classList.add('active');
                // 英語表示の処理（将来的に実装）
                alert('English language support coming soon!');
            }
        }

        // サイドメニューの開閉機能
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        // ユーザーメニューの開閉機能
        function toggleUserMenu(button) {
            const dropdown = button.nextElementSibling;
            const isOpen = dropdown.classList.contains('show');
            
            // 他のドロップダウンを閉じる
            document.querySelectorAll('.user-dropdown').forEach(d => {
                d.classList.remove('show');
            });
            document.querySelectorAll('.user-menu-btn').forEach(b => {
                b.classList.remove('active');
            });
            
            if (!isOpen) {
                dropdown.classList.add('show');
                button.classList.add('active');
            }
        }

        // サブメニューの開閉機能
        function toggleSubmenu(element) {
            event.preventDefault();
            
            const submenu = element.nextElementSibling;
            const toggle = element.querySelector('.sidebar-toggle');
            
            if (submenu && submenu.classList.contains('sidebar-submenu')) {
                submenu.classList.toggle('open');
                toggle.classList.toggle('open');
            }
        }

        // ESCキーでサイドメニューを閉じる
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const sidebar = document.getElementById('sidebar');
                const overlay = document.querySelector('.sidebar-overlay');
                
                if (sidebar.classList.contains('open')) {
                    sidebar.classList.remove('open');
                    overlay.classList.remove('active');
                }
            }
        });

        // 画面外クリックでドロップダウンを閉じる
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.user-menu')) {
                document.querySelectorAll('.user-dropdown').forEach(d => {
                    d.classList.remove('show');
                });
                document.querySelectorAll('.user-menu-btn').forEach(b => {
                    b.classList.remove('active');
                });
            }
        });

        // 初期化時にリスクリワード比とプログレスバーを設定
        updateRiskReward();
        
        // 初期プログレスバーの設定
        const initialTpProgress = ((selectedTpPips - 10) / (100 - 10)) * 100;
        const initialSlProgress = ((selectedSlPips - 10) / (100 - 10)) * 100;
        document.getElementById('tpPipsSlider').style.setProperty('--progress', initialTpProgress + '%');
        document.getElementById('slPipsSlider').style.setProperty('--progress', initialSlProgress + '%');

    </script>
</body>
</html>