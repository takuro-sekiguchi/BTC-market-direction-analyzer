<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTC市場方向性スコア ダッシュボード</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #0a0e1a;
            color: #ffffff;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ヘッダー */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid #1a2332;
            margin-bottom: 30px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #00d4ff, #0099ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .view-switcher {
            display: flex;
            gap: 10px;
            background: #1a2332;
            padding: 5px;
            border-radius: 30px;
        }

        .view-btn {
            padding: 8px 20px;
            border: none;
            background: transparent;
            color: #7a8a9a;
            cursor: pointer;
            border-radius: 25px;
            transition: all 0.3s;
        }

        .view-btn.active {
            background: #00d4ff;
            color: #0a0e1a;
        }

        /* シグナルビュー */
        .signal-view {
            display: block;
        }

        .main-score-card {
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .score-meter {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto 40px;
        }

        .meter-background {
            height: 60px;
            background: #0f1722;
            border-radius: 30px;
            position: relative;
            overflow: hidden;
        }

        .meter-gradient {
            height: 100%;
            background: linear-gradient(to right, 
                #ff3b3b 0%, 
                #ff6b6b 25%, 
                #ffa500 40%, 
                #ffdd00 50%, 
                #90ee90 60%, 
                #00d4ff 75%, 
                #0099ff 100%);
            opacity: 0.3;
        }

        .meter-pointer {
            position: absolute;
            top: -10px;
            transform: translateX(-50%);
            transition: left 0.5s ease-out;
        }

        .pointer-value {
            background: #ffffff;
            color: #0a0e1a;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .pointer-arrow {
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 15px solid #ffffff;
            margin: 0 auto;
        }

        .score-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            color: #7a8a9a;
        }

        .confidence-section {
            text-align: center;
            margin: 30px 0;
        }

        .confidence-indicator {
            display: inline-flex;
            gap: 10px;
            background: #0f1722;
            padding: 15px 30px;
            border-radius: 30px;
        }

        .confidence-light {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #2a3a4a;
            transition: all 0.3s;
        }

        .confidence-light.active-high {
            background: #00ff00;
            box-shadow: 0 0 20px #00ff00;
        }

        .confidence-light.active-medium {
            background: #ffdd00;
            box-shadow: 0 0 20px #ffdd00;
        }

        .confidence-light.active-low {
            background: #ff3b3b;
            box-shadow: 0 0 20px #ff3b3b;
        }

        .action-recommendation {
            background: #0f1722;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }

        .recommendation-text {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .recommendation-text.buy {
            color: #00ff00;
        }

        .recommendation-text.hold {
            color: #ffdd00;
        }

        .recommendation-text.sell {
            color: #ff3b3b;
        }

        .ai-explanation {
            background: #1a2332;
            border-left: 4px solid #00d4ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .ai-explanation h3 {
            color: #00d4ff;
            margin-bottom: 10px;
        }

        /* 分析ビュー */
        .analysis-view {
            display: none;
        }

        .timeframe-matrix {
            background: #1a2332;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
        }

        .matrix-table th,
        .matrix-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #2a3a4a;
        }

        .matrix-table th {
            background: #0f1722;
            font-weight: 600;
            color: #7a8a9a;
        }

        .score-cell {
            font-size: 24px;
            font-weight: bold;
        }

        .score-positive {
            color: #00ff00;
        }

        .score-negative {
            color: #ff3b3b;
        }

        .score-neutral {
            color: #ffdd00;
        }

        .module-contributions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .module-card {
            background: #1a2332;
            border-radius: 15px;
            padding: 20px;
        }

        .module-card h4 {
            color: #00d4ff;
            margin-bottom: 15px;
        }

        .contribution-bar {
            background: #0f1722;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .contribution-fill {
            height: 100%;
            transition: width 0.5s;
        }

        .contribution-fill.positive {
            background: linear-gradient(to right, #00d4ff, #00ff00);
        }

        .contribution-fill.negative {
            background: linear-gradient(to right, #ff3b3b, #ff6b6b);
        }

        .price-levels {
            background: #1a2332;
            border-radius: 15px;
            padding: 20px;
        }

        .level-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #2a3a4a;
        }

        .level-price {
            font-weight: bold;
            color: #ffffff;
        }

        .level-type {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
        }

        .level-resistance {
            background: #ff3b3b;
        }

        .level-support {
            background: #00ff00;
        }

        /* プロビュー */
        .pro-view {
            display: none;
        }

        .pro-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }

        .module-detail {
            background: #1a2332;
            border-radius: 15px;
            padding: 20px;
        }

        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #2a3a4a;
            padding-bottom: 10px;
        }

        .module-score {
            font-size: 28px;
            font-weight: bold;
        }

        .data-list {
            list-style: none;
        }

        .data-list li {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #0f1722;
        }

        .data-label {
            color: #7a8a9a;
        }

        .data-value {
            font-weight: 600;
        }

        /* タイムフレームボタン */
        .timeframe-buttons {
            display: flex;
            gap: 5px;
            background: #1a2332;
            padding: 5px;
            border-radius: 25px;
        }

        .timeframe-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: #7a8a9a;
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }

        .timeframe-btn:hover {
            background: #2a3a4a;
            color: #ffffff;
        }

        .timeframe-btn.active {
            background: #00d4ff;
            color: #0a0e1a;
        }

        /* スコアスライダー */
        .score-control {
            margin: 30px 0;
            padding: 20px;
            background: #0f1722;
            border-radius: 15px;
            border: 1px solid #1a2332;
        }

        .slider-container {
            position: relative;
            margin: 20px 0;
        }

        .score-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(to right, 
                #ff3b3b 0%, 
                #ff6b6b 25%, 
                #ffa500 40%, 
                #ffdd00 50%, 
                #90ee90 60%, 
                #00d4ff 75%, 
                #0099ff 100%);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .score-slider::-webkit-slider-thumb {
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            border: 2px solid #00d4ff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .score-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            border: 2px solid #00d4ff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            color: #7a8a9a;
            font-size: 12px;
        }

        .current-value {
            text-align: center;
            margin-top: 15px;
            font-size: 18px;
            font-weight: bold;
            color: #00d4ff;
        }

        /* TradingViewチャート */
        .tradingview-chart {
            background: #0a0e1a !important;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #1a2332;
        }

        .tradingview-widget-container {
            background: #0a0e1a !important;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .tradingview-widget-container * {
            background-color: #0a0e1a !important;
        }

        #tradingview_btc {
            background: #0a0e1a !important;
            border-radius: 10px;
            min-height: 500px;
        }

        #tradingview_btc iframe {
            background: #0a0e1a !important;
        }

        /* TradingViewの上部ツールバーの背景色を強制 */
        .tv-header,
        .tv-header__inner,
        .tv-header__area,
        .tv-header__group,
        .tv-toolbar,
        .tv-toolbar__group {
            background-color: #0a0e1a !important;
            background: #0a0e1a !important;
        }

        /* レスポンシブ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header {
                flex-direction: column;
                gap: 20px;
            }

            .main-score-card {
                padding: 20px;
            }

            .recommendation-text {
                font-size: 24px;
            }

            .module-contributions {
                grid-template-columns: 1fr;
            }

            .pro-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">BTC Direction Score</div>
            <div class="view-switcher">
                <button class="view-btn active" onclick="switchView('signal')">シグナル</button>
                <button class="view-btn" onclick="switchView('analysis')">分析</button>
                <button class="view-btn" onclick="switchView('pro')">プロ</button>
            </div>
        </header>

        <!-- シグナルビュー（初心者向け） -->
        <div class="signal-view" id="signalView">
            <div class="main-score-card">
                <h2 style="text-align: center; margin-bottom: 30px; color: #7a8a9a;">市場方向性スコア</h2>
                <div class="score-meter">
                    <div class="meter-background">
                        <div class="meter-gradient"></div>
                    </div>
                    <div class="meter-pointer" style="left: 72%;">
                        <div class="pointer-value">+4400</div>
                        <div class="pointer-arrow"></div>
                    </div>
                    <div class="score-labels">
                        <span>-10000</span>
                        <span>-5000</span>
                        <span>0</span>
                        <span>+5000</span>
                        <span>+10000</span>
                    </div>
                </div>

                <!-- スライダーコントロール -->
                <div class="score-control">
                    <h4 style="color: #7a8a9a; margin-bottom: 15px; text-align: center;">スコア調整 (pips)</h4>
                    <div class="slider-container">
                        <input type="range" id="scoreSlider" class="score-slider" min="-10000" max="10000" value="4400" step="100">
                        <div class="slider-labels">
                            <span>-10000</span>
                            <span>-5000</span>
                            <span>0</span>
                            <span>+5000</span>
                            <span>+10000</span>
                        </div>
                    </div>
                    <div class="current-value">
                        <span id="currentScore">+4400</span> pips
                    </div>
                </div>

                <div class="confidence-section">
                    <h3 style="color: #7a8a9a; margin-bottom: 15px;">信頼度</h3>
                    <div class="confidence-indicator">
                        <div class="confidence-light active-high"></div>
                        <div class="confidence-light active-high"></div>
                        <div class="confidence-light"></div>
                    </div>
                    <p style="margin-top: 10px; color: #7a8a9a;">高信頼度（0.75）</p>
                </div>
            </div>

            <div class="action-recommendation">
                <div class="recommendation-text buy">買い推奨</div>
                <p style="color: #7a8a9a;">市場は明確な上昇傾向を示しています</p>
            </div>

            <div class="ai-explanation">
                <h3>AI解説</h3>
                <p>株式市場が3日連続で上昇し、米10年債利回りが低下中です。ETFへの資金流入も継続的に観測されており、市場全体がリスクオンに傾いています。ビットコインに資金が流入しやすい地合いとなっており、短期的な押し目は買いのチャンスとなる可能性が高いです。ただし、$45,000付近に強いレジスタンスが存在するため、その水準では一旦利益確定を検討することを推奨します。</p>
            </div>

            <!-- TradingViewチャート -->
            <div class="tradingview-chart" style="margin-top: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: #00d4ff; margin: 0;">BTC/USD チャート</h3>
                    <div class="timeframe-buttons">
                        <button class="timeframe-btn" onclick="changeTimeframe('5')">5m</button>
                        <button class="timeframe-btn" onclick="changeTimeframe('15')">15m</button>
                        <button class="timeframe-btn active" onclick="changeTimeframe('60')">1h</button>
                        <button class="timeframe-btn" onclick="changeTimeframe('240')">4h</button>
                        <button class="timeframe-btn" onclick="changeTimeframe('D')">1D</button>
                    </div>
                </div>
                <!-- TradingView Widget BEGIN -->
                <div class="tradingview-widget-container">
                    <div id="tradingview_btc"></div>
                    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
                    <script type="text/javascript">
                    // TradingView ウィジェットを直接初期化
                    new TradingView.widget({
                        "autosize": true,
                        "symbol": "BITSTAMP:BTCUSD",
                        "interval": "60",
                        "timezone": "Asia/Tokyo",
                        "theme": "dark",
                        "style": "1",
                        "locale": "ja",
                        "toolbar_bg": "#0a0e1a",
                        "enable_publishing": false,
                        "withdateranges": true,
                        "hide_side_toolbar": false,
                        "allow_symbol_change": true,
                        "container_id": "tradingview_btc",
                        "studies": [
                            "MASimple@tv-basicstudies",
                            "RSI@tv-basicstudies"
                        ],
                        "overrides": {
                            "paneProperties.background": "#0a0e1a",
                            "paneProperties.backgroundType": "solid",
                            "paneProperties.backgroundGradientStartColor": "#0a0e1a",
                            "paneProperties.backgroundGradientEndColor": "#0a0e1a",
                            "paneProperties.vertGridProperties.color": "#1a2332",
                            "paneProperties.horzGridProperties.color": "#1a2332",
                            "symbolWatermarkProperties.transparency": 90,
                            "scalesProperties.backgroundColor": "#0a0e1a",
                            "scalesProperties.textColor": "#ffffff"
                        }
                    });
                    </script>
                </div>
                <!-- TradingView Widget END -->
            </div>
        </div>

        <!-- 分析ビュー（中級者向け） -->
        <div class="analysis-view" id="analysisView">
            <div class="timeframe-matrix">
                <h3 style="margin-bottom: 20px; color: #00d4ff;">時間足別スコア</h3>
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>時間足</th>
                            <th>方向性スコア</th>
                            <th>トレンド</th>
                            <th>信頼度</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>日足</td>
                            <td class="score-cell score-positive">+6200</td>
                            <td style="color: #00ff00;">↑ 上昇</td>
                            <td>0.82</td>
                        </tr>
                        <tr>
                            <td>4時間足</td>
                            <td class="score-cell score-positive">+4800</td>
                            <td style="color: #00ff00;">↑ 上昇</td>
                            <td>0.75</td>
                        </tr>
                        <tr>
                            <td>1時間足</td>
                            <td class="score-cell score-positive">+3500</td>
                            <td style="color: #00ff00;">↑ 上昇</td>
                            <td>0.70</td>
                        </tr>
                        <tr>
                            <td>15分足</td>
                            <td class="score-cell score-neutral">+1200</td>
                            <td style="color: #ffdd00;">→ 中立</td>
                            <td>0.65</td>
                        </tr>
                        <tr>
                            <td>5分足</td>
                            <td class="score-cell score-negative">-800</td>
                            <td style="color: #ff3b3b;">↓ 調整</td>
                            <td>0.58</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="module-contributions">
                <div class="module-card">
                    <h4>市場資金循環</h4>
                    <div class="contribution-bar">
                        <div class="contribution-fill positive" style="width: 75%;"></div>
                    </div>
                    <p>スコア: +7500</p>
                    <p style="color: #7a8a9a; font-size: 14px;">株式市場好調、リスクオン環境</p>
                </div>

                <div class="module-card">
                    <h4>マクロ環境</h4>
                    <div class="contribution-bar">
                        <div class="contribution-fill positive" style="width: 60%;"></div>
                    </div>
                    <p>スコア: +6000</p>
                    <p style="color: #7a8a9a; font-size: 14px;">金利低下見通し、緩和的</p>
                </div>

                <div class="module-card">
                    <h4>BTC需給</h4>
                    <div class="contribution-bar">
                        <div class="contribution-fill positive" style="width: 85%;"></div>
                    </div>
                    <p>スコア: +8500</p>
                    <p style="color: #7a8a9a; font-size: 14px;">ETF継続流入、取引所残高減少</p>
                </div>

                <div class="module-card">
                    <h4>市場心理</h4>
                    <div class="contribution-bar">
                        <div class="contribution-fill positive" style="width: 40%;"></div>
                    </div>
                    <p>スコア: +4000</p>
                    <p style="color: #7a8a9a; font-size: 14px;">楽観優勢、過熱感なし</p>
                </div>

                <div class="module-card">
                    <h4>ポジション構造</h4>
                    <div class="contribution-bar">
                        <div class="contribution-fill negative" style="width: 20%;"></div>
                    </div>
                    <p>スコア: -2000</p>
                    <p style="color: #7a8a9a; font-size: 14px;">ロング偏り、調整リスクあり</p>
                </div>

                <div class="module-card">
                    <h4>クジラ動向</h4>
                    <div class="contribution-bar">
                        <div class="contribution-fill positive" style="width: 55%;"></div>
                    </div>
                    <p>スコア: +5500</p>
                    <p style="color: #7a8a9a; font-size: 14px;">大口蓄積フェーズ</p>
                </div>
            </div>

            <div class="price-levels">
                <h3 style="margin-bottom: 20px; color: #00d4ff;">重要価格帯</h3>
                <div class="level-item">
                    <span class="level-price">$45,000</span>
                    <span class="level-type level-resistance">強レジスタンス</span>
                </div>
                <div class="level-item">
                    <span class="level-price">$43,500</span>
                    <span class="level-type level-resistance">レジスタンス</span>
                </div>
                <div class="level-item">
                    <span class="level-price">$42,000</span>
                    <span class="level-type level-support">サポート</span>
                </div>
                <div class="level-item">
                    <span class="level-price">$40,000</span>
                    <span class="level-type level-support">強サポート</span>
                </div>
            </div>
        </div>

        <!-- プロビュー（上級者向け） -->
        <div class="pro-view" id="proView">
            <div class="pro-grid">
                <div class="module-detail">
                    <div class="module-header">
                        <h3>市場資金循環</h3>
                        <span class="module-score score-positive">+7500</span>
                    </div>
                    <ul class="data-list">
                        <li>
                            <span class="data-label">S&P500（3日変化率）</span>
                            <span class="data-value">+2.1%</span>
                        </li>
                        <li>
                            <span class="data-label">NASDAQ100</span>
                            <span class="data-value">+2.8%</span>
                        </li>
                        <li>
                            <span class="data-label">DXY（ドル指数）</span>
                            <span class="data-value">-0.5%</span>
                        </li>
                        <li>
                            <span class="data-label">US10Y（米10年債）</span>
                            <span class="data-value">4.12% ↓</span>
                        </li>
                        <li>
                            <span class="data-label">金（XAU/USD）</span>
                            <span class="data-value">-1.2%</span>
                        </li>
                        <li>
                            <span class="data-label">暗号資産時価総額</span>
                            <span class="data-value">+4.5%</span>
                        </li>
                    </ul>
                </div>

                <div class="module-detail">
                    <div class="module-header">
                        <h3>BTC需給</h3>
                        <span class="module-score score-positive">+8500</span>
                    </div>
                    <ul class="data-list">
                        <li>
                            <span class="data-label">ETF純流入（日次）</span>
                            <span class="data-value">+$285M</span>
                        </li>
                        <li>
                            <span class="data-label">取引所BTC残高</span>
                            <span class="data-value">-12,000 BTC</span>
                        </li>
                        <li>
                            <span class="data-label">長期保有者比率</span>
                            <span class="data-value">67.2% ↑</span>
                        </li>
                        <li>
                            <span class="data-label">ハッシュレート</span>
                            <span class="data-value">420 EH/s</span>
                        </li>
                        <li>
                            <span class="data-label">マイナー売却</span>
                            <span class="data-value">通常レベル</span>
                        </li>
                    </ul>
                </div>

                <div class="module-detail">
                    <div class="module-header">
                        <h3>ポジション構造</h3>
                        <span class="module-score score-negative">-2000</span>
                    </div>
                    <ul class="data-list">
                        <li>
                            <span class="data-label">Open Interest</span>
                            <span class="data-value">$14.2B ↑</span>
                        </li>
                        <li>
                            <span class="data-label">Funding Rate</span>
                            <span class="data-value">0.025%</span>
                        </li>
                        <li>
                            <span class="data-label">ロング/ショート比</span>
                            <span class="data-value">1.85</span>
                        </li>
                        <li>
                            <span class="data-label">清算帯（上）</span>
                            <span class="data-value">$45,500</span>
                        </li>
                        <li>
                            <span class="data-label">清算帯（下）</span>
                            <span class="data-value">$41,200</span>
                        </li>
                    </ul>
                </div>

                <div class="module-detail">
                    <div class="module-header">
                        <h3>市場心理</h3>
                        <span class="module-score score-positive">+4000</span>
                    </div>
                    <ul class="data-list">
                        <li>
                            <span class="data-label">ニューストーン</span>
                            <span class="data-value">楽観的</span>
                        </li>
                        <li>
                            <span class="data-label">SNSセンチメント</span>
                            <span class="data-value">72% ポジティブ</span>
                        </li>
                        <li>
                            <span class="data-label">検索トレンド</span>
                            <span class="data-value">上昇中</span>
                        </li>
                        <li>
                            <span class="data-label">Fear & Greed</span>
                            <span class="data-value">68 (貪欲)</span>
                        </li>
                    </ul>
                </div>

                <div class="module-detail">
                    <div class="module-header">
                        <h3>異常検知</h3>
                        <span class="module-score score-positive">+9000</span>
                    </div>
                    <ul class="data-list">
                        <li>
                            <span class="data-label">スコア整合性</span>
                            <span class="data-value">正常</span>
                        </li>
                        <li>
                            <span class="data-label">急激な変動</span>
                            <span class="data-value">検出なし</span>
                        </li>
                        <li>
                            <span class="data-label">ニュース急増</span>
                            <span class="data-value">通常レベル</span>
                        </li>
                        <li>
                            <span class="data-label">システム信頼度</span>
                            <span class="data-value">92%</span>
                        </li>
                    </ul>
                </div>

                <div class="module-detail">
                    <div class="module-header">
                        <h3>経済イベント</h3>
                        <span class="module-score score-neutral">0</span>
                    </div>
                    <ul class="data-list">
                        <li>
                            <span class="data-label">次回イベント</span>
                            <span class="data-value">CPI (3日後)</span>
                        </li>
                        <li>
                            <span class="data-label">市場予想</span>
                            <span class="data-value">3.2%</span>
                        </li>
                        <li>
                            <span class="data-label">前回実績</span>
                            <span class="data-value">3.4%</span>
                        </li>
                        <li>
                            <span class="data-label">影響度</span>
                            <span class="data-value">高</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        function switchView(view) {
            // すべてのビューを非表示
            document.getElementById('signalView').style.display = 'none';
            document.getElementById('analysisView').style.display = 'none';
            document.getElementById('proView').style.display = 'none';
            
            // すべてのボタンからactiveクラスを削除
            const buttons = document.querySelectorAll('.view-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // 選択されたビューを表示し、ボタンをアクティブに
            if (view === 'signal') {
                document.getElementById('signalView').style.display = 'block';
                buttons[0].classList.add('active');
            } else if (view === 'analysis') {
                document.getElementById('analysisView').style.display = 'block';
                buttons[1].classList.add('active');
            } else if (view === 'pro') {
                document.getElementById('proView').style.display = 'block';
                buttons[2].classList.add('active');
            }
        }

        // メーターのアニメーション
        setTimeout(() => {
            const pointer = document.querySelector('.meter-pointer');
            pointer.style.left = '72%';
        }, 500);

        // TradingView ウィジェット変数
        let tradingViewWidget;

        // ページ読み込み後にTradingViewを初期化
        window.addEventListener('load', function() {
            initializeTradingView();
            initializeScoreSlider();
        });

        // スライダー初期化
        function initializeScoreSlider() {
            const slider = document.getElementById('scoreSlider');
            const currentScore = document.getElementById('currentScore');
            const meterPointer = document.querySelector('.meter-pointer');
            const pointerValue = document.querySelector('.pointer-value');

            slider.addEventListener('input', function() {
                const value = parseInt(this.value);
                
                // 表示値を更新
                currentScore.textContent = value >= 0 ? '+' + value : value.toString();
                pointerValue.textContent = value >= 0 ? '+' + value : value.toString();
                
                // メーターポインター位置を更新（-10000から+10000の範囲を0%から100%に変換）
                const percentage = ((value + 10000) / 20000) * 100;
                meterPointer.style.left = percentage + '%';
                
                // 推奨アクションを更新
                updateRecommendation(value);
            });
        }

        // 推奨アクション更新
        function updateRecommendation(score) {
            const recommendation = document.querySelector('.recommendation-text');
            
            if (score > 3000) {
                recommendation.textContent = '強い買い推奨';
                recommendation.className = 'recommendation-text buy';
            } else if (score > 1000) {
                recommendation.textContent = '買い推奨';
                recommendation.className = 'recommendation-text buy';
            } else if (score > -1000) {
                recommendation.textContent = '中立・様子見';
                recommendation.className = 'recommendation-text hold';
            } else if (score > -3000) {
                recommendation.textContent = '売り推奨';
                recommendation.className = 'recommendation-text sell';
            } else {
                recommendation.textContent = '強い売り推奨';
                recommendation.className = 'recommendation-text sell';
            }
        }

        function initializeTradingView() {
            tradingViewWidget = new TradingView.widget({
                "autosize": true,
                "symbol": "BITSTAMP:BTCUSD",
                "interval": "60",
                "timezone": "Asia/Tokyo",
                "theme": "dark",
                "style": "1",
                "locale": "ja",
                "toolbar_bg": "#0a0e1a",
                "enable_publishing": false,
                "withdateranges": true,
                "hide_side_toolbar": false,
                "allow_symbol_change": true,
                "container_id": "tradingview_btc",
                "studies": [
                    "MASimple@tv-basicstudies",
                    "RSI@tv-basicstudies"
                ],
                "overrides": {
                    "paneProperties.background": "#0a0e1a",
                    "paneProperties.backgroundType": "solid",
                    "paneProperties.backgroundGradientStartColor": "#0a0e1a",
                    "paneProperties.backgroundGradientEndColor": "#0a0e1a",
                    "paneProperties.vertGridProperties.color": "#1a2332",
                    "paneProperties.horzGridProperties.color": "#1a2332",
                    "symbolWatermarkProperties.transparency": 90,
                    "scalesProperties.backgroundColor": "#0a0e1a",
                    "scalesProperties.textColor": "#ffffff"
                }
            });
        }

        // 時間足変更関数
        function changeTimeframe(interval) {
            // アクティブボタンを更新
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ウィジェットが存在する場合は時間足を変更
            if (tradingViewWidget && tradingViewWidget.chart) {
                tradingViewWidget.chart().setResolution(interval);
            } else {
                // ウィジェットが存在しない場合は再作成
                document.getElementById('tradingview_btc').innerHTML = '';
                setTimeout(() => {
                    initializeTradingView();
                }, 100);
            }
        }
    </script>
</body>
</html>